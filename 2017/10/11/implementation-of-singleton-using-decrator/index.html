<!DOCTYPE html>
<html lang="en">




<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  
  
  
  
    
  
      <title>Python单例模式:装饰器版 - Infinite.ft的博客</title>
  
  
  <meta name="description" content="">
  <meta name="author" content="infinite.ft">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Load scheme css -->
  <link rel="stylesheet" href="/css/lightgallery.css">
  





    <link rel="stylesheet" href="/css/taurus.css">
    
        <link rel="stylesheet" href="/css/scheme-taurus/animations.css">
    


  <!-- load font awesome 5 -->
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="/js/social-share.min.js"></script>
    <script src="/js/theme.js"></script>

  <!-- include cookie.js -->
  
  

  <!-- include comment system code -->
  
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  
  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

</head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">

 

<header id="header">
	<div class="header-title">
		
		<div class='header-logo'>
			<a href='/'>
				<img src='/images/avatar.png' />
			</a>
		</div>
		<div class='header-text'>
			<h1>
				<a href="/">Infinite.ft的博客</a>
			</h1>
			<subtitle>
				Hello
			</subtitle>
		</div>
		
	</div>
	<div id='header-nav'>
		



<nav id="nav">
	
	
		
			
		
		
			<div class='nav-item'>
				
					<div class="nav-name active_page">
				
					<a class='nav-link' href="/">
						<span>Home </span>
					</a>
				</div>
			</div>
		
	
	
	<div class='nav-item' id='nav-item-toc'>
		



<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用装饰器实现python单例模式"><span class="toc-number">1.</span> <span class="toc-text">使用装饰器实现python单例模式</span></a></li></ol>
<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

	</div>
	
	<div class='nav-item' id='nav-item-archive'>
		
				<div class='nav-icon'>
				
			<a href="/archives/" title='Archives'>
			<img src="/images/icons/colorful-outlined/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class='nav-item' id='nav-item-search'>
		
		<div class='nav-icon'>
		
			<a href="/search/" title='Search'>
			<img src="/images/icons/colorful-outlined/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id='nav-item-more'>
		<div class="nav-icon">
				<a href='#' onclick='onClickMenuIcon(event);' ontouchstart='onClickMenuIcon(event);'>
				<img src="/images/icons/colorful-outlined/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
		
			
			
				
			
				
			
				
			
		
			<div class='nav-more-item'>
					<div class="nav-name">
						<a class='nav-link' href="/">
							<span>Home</span>
						</a>
					</div>
			</div>
		
		
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/tech/">
						<span>Tech</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/mylife/">
						<span>Mylife</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/math/">
						<span>Math</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>
</header>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div style="flex: 1;">
      <style>
    body {
        background-color: white;
    }
</style>









    
        
            
            
        
    









    
    
        
    

    
        
    









<article class="article" id="/2017/10/11/implementation-of-singleton-using-decrator/" data-name='Python单例模式:装饰器版' data-version="">

    <!-- Title -->
    <div class='article-header'>
         
         <h1 class='article-title'>
            <a href="/2017/10/11/implementation-of-singleton-using-decrator/">
                Python单例模式:装饰器版
            </a>
        </h1>
        <!-- TODO: support nested categories,display them nicely -->
        
        <ul class='article-categories'>
            
            
                <li><a href="/categories/tech/" data-no-instant>
                    <img src="/images/tech.svg" alt="tech" onerror='if(this.src != "/images/uncategorized.svg") this.src="/images/uncategorized.svg"' title='tech'/>
                </a></li>
            
        </ul>
        
    </div>
    
    <!-- Date and Author -->
    <div class='article-meta'>
    <ul>
            <li><i class='fa fa-calendar'></i> 2017-10-11</li>
            
            <li><i class="fa fa-user"></i> infinite.ft</li>
            
            <li><i class="fas fa-copyright"></i>
            
                
                
            
            
                <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>CC BY-NC-ND 4.0</a>
            
            </li>
    </ul>
    
<div class="tags">
	
		
			<label class='tag-1'><a href="/tags/python/">Python</a></label>
		
	
	</div>

    </div>
    <div class='article-cards'>
        <!-- Author Card -->
        <!---
        <div class='Card-article Card-author'>
            <div class='card-title'>
                <h3></h3>
            </div>
            <div class='card-content'>
                    <div class="author-meta">
                            <div class='author-figure'>
                                <img src="" alt="">
                            </div>
                            <div class='author-name'>
                                infinite.ft
                            </div>
                        </div>
                        <div class="author-ai">
                            <div class='author-intro'>
                                <!-- TODO: auto generating author description -->
                                <!-- 
                            </div>
                            <div class="author-articles">
                                <!-- TODO: auto generating author articles -->
                                <!-- <ul>
                                    <li>Article 1</li>
                                    <li>Article 2</li>
                                    <li>Article 3</li>
                                    <li>Article 4</li>
                                    <li>Article 5</li>
                                    <li>Article 6</li>
                                </ul>
                            </div>
                        </div>
            </div>
            
        </div> -->

        <!-- Visit Card -->
        <!-- <div class="Card-article Card-visit"> -->
            <!-- <div class="card-title">
  <h3>Post Visit</h3>
</div>
<div class="card-chart">
  <div id='chart-post-visit'></div>
</div> -->
        <!-- </div> -->
        
        <!-- Auto Excerpt Card -->
        <!-- <div class="Card-article Card-excerpt">
            <div class="card-title">
  <h3>Quick Read</h3>
</div>
<div class="card-text">
  <p id='text-post-summary'>使用装饰器实现python单例模式
1.概述
不同的编程语言所支持的语言特性不一样，导致实现单例模式的方式也各不相同。python作为一门动态语言，有很大的灵活性，实现的单例模式的方式也不尽相同，在这里总结一下python实现单例模式的方法，以便之后学习。本系列主要简述4种方式实现单例模式:

装饰器实现单例模式[1]1


元类实现单例模式
__new__方法实现单例模式
共享__dict__实现单例模式

本节主要简述使用装饰器实现单例模式。
2. 实现
plateform:

python3.5
ubuntu16.04

code:
def singleton(cls):
   ...</p>
</div>
        </div> -->
    </div>
    
    <!-- Gallery -->
    <!-- TODO: add a slider to gallery -->
    

    <!-- Content -->
    <!-- TODO: support table of content -->
    <div class="article-toc" id='article-toc'>
        



<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用装饰器实现python单例模式"><span class="toc-number">1.</span> <span class="toc-text">使用装饰器实现python单例模式</span></a></li></ol>
<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

    </div>
    <div class='article-content'>
    <h2 id="使用装饰器实现python单例模式">使用装饰器实现python单例模式</h2>
<h3 id="1-概述">1.概述</h3>
<p>不同的编程语言所支持的语言特性不一样，导致实现单例模式的方式也各不相同。python作为一门动态语言，有很大的灵活性，实现的单例模式的方式也不尽相同，在这里总结一下python实现单例模式的方法，以便之后学习。本系列主要简述4种方式实现单例模式:</p>
<ul>
<li><strong>装饰器实现单例模式[<a href="http://ghostfromheaven.iteye.com/blog/1562618" target="_blank" rel="external">1</a>]<a href="http://ghostfromheaven.iteye.com/blog/1562618" target="_blank" rel="external">1</a></strong></li>
</ul>
<ul>
<li><strong>元类实现单例模式</strong></li>
<li><strong>__new__方法实现单例模式</strong></li>
<li><strong>共享__dict__实现单例模式</strong></li>
</ul>
<p>本节主要简述使用装饰器实现单例模式。</p>
<h3 id="2-实现">2. 实现</h3>
<p><strong>plateform</strong>:</p>
<ul>
<li>python3.5</li>
<li>ubuntu16.04</li>
</ul>
<p><strong>code</strong>:</p>
<pre><code class="language-python">def singleton(cls):
    instances = {}
    def singleton_wrapper(*args, **kwargs):
        if cls not in instances:
            instances[cls] = cls(*args, **kwargs)
        return instances[cls]
    return singleton_wrapper

  
@singleton
class Point2D(object):

    def __init__(self, x=0, y=0):
        self._x = x
        self._y = y
       
    @property
    def x(self):
        return self._x
      
    @property
    def y(self):
        return self._y
      
    @x.setter
    def x(self, val):
        self._x = val
        
    @y.setter
    def y(self, val):
        self._y = val
        
        
if __name__ == '__main__':
    p1 = Point2D(1, 10)
    p2 = Point2D(2, 10)
    print(id(p1))
    print(id(p2))
</code></pre>
<p><strong>output</strong>:</p>
<pre><code class="language-bash">139685819815696
139685819815696
</code></pre>
<p>由输出可知p1和p2为同一示例，即上述code完美实现了单例模式。</p>
<h3 id="3-code-辩证分析">3.code 辩证分析</h3>
<p>在单例的装饰器函数中，使用词典变量<strong>instances</strong>来储存类的实例，并且<strong>singleton_wrapper</strong>与<strong>instances</strong>形成了闭包环境。当使用<code>类名(*args, **kwargs)</code>实例化时，实际上调用了<code>singleton_wrapper(*args, **kwargs)</code>来进行实例化。通过在<strong>singleton_wrapper</strong>判断<strong>instances</strong>中是否存在类的实例，如果不存在则创建实例，如果存在则直接中从<strong>instances</strong>返回实例。每调用一次<strong>singleton</strong>返回一个闭包，各个闭包之间并没有共享<strong>instances</strong>变量，所以<strong>instances</strong>变量中最多只储存了一个实例，为了验证此将code修改成如下：</p>
<pre><code class="language-python">def singleton(cls):
    instances = {}
    def singleton_wrapper(*args, **kwargs):
        if cls not in instances:
            instances[cls] = cls(*args, **kwargs)
        print(instances)
        return instances[cls]
    return singleton_wrapper
  
@singleton
class ClassOne(object):
  
  
    def __init__(self):
  	    pass
  
  
  
@singleton
class ClassTwo(object):


    def __init__(self):
        pass
  


if __name__ == '__main__':
    obj1 = ClassOne()
    obj2 = ClassTwo()
  
</code></pre>
<p><strong>output</strong></p>
<pre><code class="language-bash">{&lt;class '__main__.ClassOne'&gt;: &lt;__main__.ClassOne object at 0x7f276523a828&gt;}
{&lt;class '__main__.ClassTwo'&gt;: &lt;__main__.ClassTwo object at 0x7f276523a940&gt;}
</code></pre>
<p>从以上输出可以看出，各个类闭包之间没有共享<strong>instances</strong>字典变量，这时小黄鸭问那为什么还需要一个字典变量来保存类的实例，何不直接使用一个普通的变量来保存类的实例呢?说的太多不如直接上code验证一下</p>
<pre><code class="language-python">def singleton(cls):
    instance = None
    def singleton_wrapper(*args, **kwargs):
        if not instance:
            instance = cls(*args, **kwargs)
        return instance
    return singleton_wrapper
  
  
@singleton
class ClassOne(object):
  
  
    def __init__(self):
  	    pass


if __name__ == '__main__':
    obj1 = ClassOne()
</code></pre>
<p><strong>output</strong></p>
<pre><code class="language-bash">Traceback (most recent call last):
  File &quot;test.py&quot;, line 21, in &lt;module&gt;
    obj1 = ClassOne()
  File &quot;test.py&quot;, line 6, in singleton_wrapper
    if not instance:
UnboundLocalError: local variable 'instance' referenced before assignment
</code></pre>
<p>输出结果如上，在<strong>singleton_wrapper</strong>中访问<strong>instance</strong>变量时，遇到<em>UnboundLocalError</em>错误。在这里之所以抛出<em>UnboundLocalError</em>，和python的词法作用域有关。<strong>python内部函数只能访问全局变量不可对全局变量进行赋值修改；当在内部函数中修改同名的全局变量时，则python会认为它是一个局部变量；在内部函数中修改同名全局变量之前读取变量名时，会引发UnboundLocalError错误[<a href="http://blog.csdn.net/my2010sam/article/details/17735159" target="_blank" rel="external">2</a>]<a href="http://blog.csdn.net/my2010sam/article/details/17735159" target="_blank" rel="external">2</a>。<strong>说到这里结果好像已经很明显了，既然不能在内部函数中赋值修改一个全局变量，那我们只需要在修改的变量之前，加一个</strong>global</strong>关键字就能解决了。好吧，还是需要用code来验证一下</p>
<p><strong>note！！！：这里的赋值修改不包括list 或者dict的添加，删除等操作；这也证明我们一开始使用dict来存类实例，巧妙避过UnboundLocalError的问题，god, are you kidding me?</strong></p>
<pre><code class="language-python">def singleton(cls):
    instance = None
    def singleton_wrapper(*args, **kwargs):
        global instance
        if not instance:
            instance = cls(*args, **kwargs)
        return instance
    return singleton_wrapper
  
  
@singleton
class ClassOne(object):
  
  
    def __init__(self):
  	    pass


if __name__ == '__main__':
    obj1 = ClassOne()
</code></pre>
<p><strong>output</strong></p>
<pre><code class="language-bash">Traceback (most recent call last):
  File &quot;test.py&quot;, line 30, in &lt;module&gt;
    obj1 = ClassOne()
  File &quot;test.py&quot;, line 7, in singleton_wrapper
    if not instance:
NameError: name 'instance' is not defined
</code></pre>
<p>what?又出错了，这次遇到了<em>NameError</em>，简直像是唐僧取经一难又一难。好吧，请不要放弃，让我们继续分析为什么会出现<em>NameError</em>。我们在<strong>singleton_wrapper</strong>中添加<strong>global</strong>关键字时就意味着直接去全局作用域搜索<strong>instance</strong>变量，但在全局作用域中并没有<strong>instance</strong>的存在，所以在这里出现<em>NameError</em>是再正常不过的。这时让我们重新回到上一步，看一下python的词法作用域的规则:</p>
<blockquote>
<p>python内部函数只能访问全局变量不可对全局变量进行赋值修改；</p>
<p>当在内部函数中修改同名的全局变量时，则python会认为它是一个局部变量；</p>
<p>在内部函数中修改同名全局变量之前读取变量名时，会引发UnboundLocalError错误。</p>
</blockquote>
<p>仔细研读和思考后，我们发现，<strong>instance</strong>对于<strong>singleton_wrapper</strong>并不是全局变量，而是extenal 变量。好吧我们以偏概全了，太大意了。事已到此好像已经没有思路，这个时候该是Google大神显神通的时候，在Google大神的帮助下，我们终于找到了一点思路,让我们穿到墙外去看一看这两篇文章吧[<a href="https://eli.thegreenplace.net/2011/05/15/understanding-unboundlocalerror-in-python" target="_blank" rel="external">3</a>][3][<a href="https://stackoverflow.com/questions/141642/what-limitations-have-closures-in-python-compared-to-language-x-closures" target="_blank" rel="external">4</a>]<a href="https://stackoverflow.com/questions/141642/what-limitations-have-closures-in-python-compared-to-language-x-closures" target="_blank" rel="external">4</a>。这两篇文章指出：</p>
<blockquote>
<p>在closures中不能对external进行赋值修改;</p>
<p>当在closures中修改同名external变量之前读取变量名，会引发UnboundLocalError错误。</p>
</blockquote>
<p>现在可谓大彻大悟了，终于搞清楚了出现<em>UnboundLocalError</em>的真正原因了。那么问题来了，有没有办法可以赶跑这个该死的<em>UnboundLocalError</em>呢?办法肯定是有的，我们娓娓道来</p>
<p><strong>python2.x</strong>:</p>
<p>使用<strong>dict</strong>或者<strong>list</strong>是最明智的选择，也是唯一的办法。</p>
<p><strong>python3.x:</strong></p>
<ol>
<li>
<p>使用<strong>dict</strong>或者<strong>list</strong>储存类实例</p>
</li>
<li>
<p>在closures中访问修改external 变量之前，使用<strong>nonlocal</strong>对external变量进行声明，<strong>nonlocal</strong>关键字是python3.0之后加入的新关键字,说明如下:</p>
</li>
</ol>
<blockquote>
<p>The <code>nonlocal</code> statement causes the listed identifiers to refer to previously bound variables in the nearest enclosing scope excluding globals. This is important because the default behavior for binding is to search the local namespace first. The statement allows encapsulated code to rebind variables outside of the local scope besides the global (module) scope.</p>
</blockquote>
<p>经过我们不断思考与实践，结局还不赖。让我们把完整的code写下来吧</p>
<pre><code class="language-python">def singleton1(cls):
    instances = {}
    def singleton_wrapper(*args, **kwargs):
        if cls not in instances:
            instances[cls] = cls(*args, **kwargs)
        return instances[cls]
    return singleton_wrapper

def singleton2(cls):
    instance = None
    def singleton_wrapper(*args, **kwargs):
        nonlocal instance
        if not instance:
            instance = cls(*args, **kwargs)
        return instance
    return singleton_wrapper
  
  
@singleton1
class Point2D(object):


    def __init__(self, x=0, y=0):
        self._x = x
        self._y = y
       
    @property
    def x(self):
        return self._x
      
    @property
    def y(self):
        return self._y
      
    @x.setter
    def x(self, val):
        self._x = val
        
    @y.setter
    def y(self, val):
        self._y = val

        
@singleton2
class Point3D(object):


    def __init__(self, x=0, y=0, z=0):
        self._x = x
        self._y = y
        self._z = z
    
  
        
if __name__ == '__main__':
    p1 = Point2D(1, 10)
    p2 = Point2D(2, 10)
    print(id(p1))
    print(id(p2))
    p3 = Point3D(10, 10, 10)
    p4 = Point3D(100, 100, 100)
    print(id(p3))
    print(id(p4))
    
</code></pre>
<p><strong>output</strong></p>
<pre><code class="language-python">140322002741008
140322002741008
140322002741176
140322002741176
</code></pre>
<h3 id="参考">参考</h3>
<p><a href="http://ghostfromheaven.iteye.com/blog/1562618" target="_blank" rel="external">[1]  Python单例模式的4种实现方法</a></p>
<p><a href="http://blog.csdn.net/my2010sam/article/details/17735159" target="_blank" rel="external">[2]  全局变量报错-UnboundLocalError: local variable ‘l’ referenced before assignment</a></p>
<p><a href="https://eli.thegreenplace.net/2011/05/15/understanding-unboundlocalerror-in-python" target="_blank" rel="external">[3]  Understanding UnboundLocalError in Python</a></p>
<p><a href="https://stackoverflow.com/questions/141642/what-limitations-have-closures-in-python-compared-to-language-x-closures" target="_blank" rel="external">[4]  What limitations have closures in Python compared to language X closures</a></p>

    
    </div>
    
    
        
</article>
  </div>

  

<footer id='footer'>
    <div class='footer-copyright'>
        <div>
            <p> Copyright by <a href="">infinite.ft </a> @ 2018</p>
            <p>Designed by: <i class="fas fa-paint-brush"></i> <a href="https://moober.cn">Moober</a> and <i class="fas fa-graduation-cap"></i> <a href="https://qutang.github.io">Qu Tang</a> &bull; Theme: <a href="">Cutie 2.0.6-beta-Taurus</a> &bull; Powered by <a href="http://hexo.io">Hexo.</a></p>
        </div>
    </div>
    
    <div class='footer-social'>
        
            
                
                    <div class='footer-social-item'><a href='https://github.com/free-free' target='_blank' ><i class="fab fa-github fa-2x" aria-hidden="true"></i></a></div>
                
            
        
    </div>
</footer>

  <br>

  <div id="footer-nav">
		



<nav id="nav">
	
	
		
			
				
			
		
		
	
	
	<div class='nav-item' id='nav-item-toc'>
		



<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用装饰器实现python单例模式"><span class="toc-number">1.</span> <span class="toc-text">使用装饰器实现python单例模式</span></a></li></ol>
<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

	</div>
	
	<div class='nav-item' id='nav-item-archive'>
		
				<div class='nav-icon'>
				
			<a href="/archives/" title='Archives'>
			<img src="/images/icons/colorful-outlined/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class='nav-item' id='nav-item-search'>
		
		<div class='nav-icon'>
		
			<a href="/search/" title='Search'>
			<img src="/images/icons/colorful-outlined/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id='nav-item-more'>
		<div class="nav-icon">
				<a href='#' onclick='onClickMenuIcon(event);' ontouchstart='onClickMenuIcon(event);'>
				<img src="/images/icons/colorful-outlined/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
		
			
			
				
			
				
			
				
			
		
			<div class='nav-more-item'>
					<div class="nav-name">
						<a class='nav-link' href="/">
							<span>Home</span>
						</a>
					</div>
			</div>
		
		
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/tech/">
						<span>Tech</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/mylife/">
						<span>Mylife</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/math/">
						<span>Math</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>

  



    







  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script src="/js/lightgallery.min.js"></script>
<script src="/js/lg-zoom.min.js"></script>
<script type='text/javascript'>
    $(document).ready(function() {
        $("#lightgallery").lightGallery(); 
        $(".article-content img").each(function(){
            console.log($(this).attr('src'))
            $(this).attr('data-src', $(this).attr('src')).lightGallery({
                selector: 'this'
            })
        });
    });
</script>








<script src="/js/post.js"></script>

<script data-no-instant type='text/javascript'>
changeLayoutOnTouchScreen();


var post = new Post('', '');
        post.getCommentCount(window.location.pathname, function(count){
            $('#article-comment-count').text(count);
        });
        post.addVisitRecord(window.location.pathname, userip);
        post.getVisitCount(window.location.pathname, function(count){
            $('#article-visit-count').text(count);
        });
post.updatePostVersion(window.location.pathname);


</script>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
