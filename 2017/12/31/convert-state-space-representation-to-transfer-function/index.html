<!DOCTYPE html><html lang="en,zh-cn,default"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Convert State Space Representation to Transfer Function · Infinite.ft的博客</title><meta name="description" content="Convert State Space Representation to Transfer Function - infinite.ft"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://free-free.github.io/atom.xml" title="Infinite.ft的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">HOME</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/categories/math" target="_self" class="nav-list-link">MATH</a></li><li class="nav-list-item"><a href="/categories/tech" target="_self" class="nav-list-link">TECH</a></li><li class="nav-list-item"><a href="/categories/mylife" target="_self" class="nav-list-link">NOTES</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Convert State Space Representation to Transfer Function</h1><div class="post-info">Dec 31, 2017</div><div class="post-content"><p>In this semester early, I have enrolled my first-degree course <em>Linear System Theory</em>. The focus of this course is the state space representation  and illustrate the concept of observable and controllable of a linear system. As a student of Control Science and Engineering, I know how  important of it to my career in later life. Everything must be practical, this course is also not an exception. here, as a practice , <strong>I will give a implementation of converting state space to transfer function representation.</strong></p>
<h3 id="Mathematical-representation"><a href="#Mathematical-representation" class="headerlink" title="Mathematical representation"></a>Mathematical representation</h3><p>Given the transfer function of a linear time invariant (LTI) system,as shown below.</p>
<script type="math/tex; mode=display">G(s) = \frac{b\_{m}s^m + b\_{m-1}s^{m-1}+ \dotsb + b\_{1}s + b\_{0}}{s^n + \alpha\_{n-1}s^{n-1} + \alpha\_{n-2}s^{n-2} + \dotsb + \alpha\_{1}s+\alpha\_{0}}</script><p>It’s state space representation as follows.</p>
<script type="math/tex; mode=display">\begin{cases}\dot{x} = Ax + Bu \\\\ y = Cx + Du\end{cases}</script><p> In the above equation,\(x\) is the state vector of system, \(u\) is the input and \(y\) is the output. \(A\) called system matrix, it’s dimension is \(n\times n\) .B called input matrix, it’s dimension is \(n \times p\). \(C \) called output matrix , it’s dimension is \(q \times n\). D called input &amp; output relational matrix, it’s dimension is \(q \times p\).</p>
<p>According to system’s transfer function , it’s <em>kalman I form</em>  , <em>kalman II form</em> and <em>standard observable  form</em> can be easily provided. Conversely,  given the state space representation , the transfer function could be given in the following formula.</p>
<script type="math/tex; mode=display">G(s) = C(sI - A)^{-1}B + D</script><p>Here the calculation of \((sI - A)^{-1}\) is cumbersome,  especially for student who has no assistance with computer.The computational  method of \((sI - A)^{-1}\) can be given in a more comprehensive way, as shown below.</p>
<script type="math/tex; mode=display">(sI - A)^{-1} = \frac{adj(sI - A)}{det(sI - A)}</script><script type="math/tex; mode=display">adj(sI - A) = R\_{n-1}s^{n-1} +R\_{n-2}s^{n-2} + \dotsb + R\_1s + R\_0</script><script type="math/tex; mode=display">det(sI - A) = s^n + a\_{n-1}s^{n-1} + a\_{n-2}s^{n-2}+ \dotsb + a\_1s + a\_0</script><p>So here i have already given  the method of computation of \((sI - A)^{-1}\), the next question is how to calculate \(R_{n-1}, R_{n-2}, \dots, R_0\) and \(a_{n-1}, a_{n-1}, \dots, a_{0}\). The relationship of them is brief and clear.</p>
<script type="math/tex; mode=display">\begin{cases} R\_{n-1} =  I,a\_{n-1} = - \frac{tr(R\_{n-1}A)}{1} \\\\ R\_{n-2} = R\_{n-1}A + a\_{n-1}I, a\_{n-2}= -\frac{tr(R\_{n-2}A)}{2} \\\\ \cdots \\\\  \cdots \\\\ R\_{1} = R\_{2}A + a\_{2}I, a\_{1}= -\frac{tr(R\_{1}A)}{(n-1)} \\\\ R\_{0} = R\_{1}A + a\_{1}I, a\_{0}= -\frac{tr(R\_{0}A)}{n}\end{cases}</script><p>As shown above,  \(R_{n-1} \)and \(a_{n-1}\)are firstly calculated, \(R_{n-2}\) and \(a_{n-2}\) are followed, then continue the calculation process until the subscript of \(R\) and \(a\) is reached to \(0\) According to equations above, we can easily give the implementation of converting to state space representation to transfer function representation using Matlab. </p>
<h3 id="Matlab-implementation"><a href="#Matlab-implementation" class="headerlink" title="Matlab implementation"></a>Matlab implementation</h3><p>In the previous section, we already have introduced mathematics basis of state space representation and transfer function representation of the linear system, and given the method of conversion between each other. So the process of implementing it is much easier using computer language, here I give an implementation using Matlab, the code as follows.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment">% @file: ss2tf.m</span></div><div class="line"><span class="comment">% @description: </span></div><div class="line"><span class="comment">%     The reponsibility of this function is to convert the linear </span></div><div class="line"><span class="comment">%     system's state  space representation to transfer function</span></div><div class="line"><span class="comment">%     representation.</span></div><div class="line"><span class="comment">% @paras: A, system matrix</span></div><div class="line"><span class="comment">% @paras: B, input matrix</span></div><div class="line"><span class="comment">% @paras: C, ouput matrix</span></div><div class="line"><span class="comment">% @paras: D, input&amp;ouput relational matrix</span></div><div class="line"><span class="comment">% @return: G, transfer function</span></div><div class="line"><span class="comment">% @return: CSAI, the inverse matrix of characteristic matrix of A</span></div><div class="line"><span class="comment">%</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="params">[G, CSAI]</span> = <span class="title">ss2tf</span><span class="params">(A, B, C, D)</span></span></div><div class="line">    <span class="comment">% Get the dimension number of state space representation</span></div><div class="line">    n = <span class="built_in">size</span>(A, <span class="number">1</span>);</div><div class="line">    <span class="comment">% Generate the identity matrix which's dimension size is same as A</span></div><div class="line">    I = <span class="built_in">eye</span>(<span class="built_in">size</span>(A));</div><div class="line">    <span class="comment">% Coefficient array of determinant of A</span></div><div class="line">    coef = <span class="built_in">ones</span>(n, <span class="number">1</span>);</div><div class="line">    <span class="comment">% R matrix </span></div><div class="line">    Rx = <span class="built_in">zeros</span>(n, n ,n);</div><div class="line">    <span class="comment">% Calculate the Rn-1</span></div><div class="line">    Rx(:, :, <span class="number">1</span>) = I;</div><div class="line">    <span class="comment">% Calculate the an-1</span></div><div class="line">    coef(<span class="number">1</span>) = -trace(I * A);</div><div class="line">    <span class="comment">% Define the laplace variable 's'</span></div><div class="line">    s = tf(<span class="string">'s'</span>);</div><div class="line">    <span class="comment">% Calculate the first part of R = Rn-1 * Sn-1</span></div><div class="line">    R = Rx(:, :, <span class="number">1</span>) * s^(n<span class="number">-1</span>);</div><div class="line">    <span class="comment">% Calculate the first and second part of determinant of A</span></div><div class="line">    <span class="comment">% i.e. s^n + an-1 * s^(n-1) + ... + a0</span></div><div class="line">    detSA = s^n + coef(<span class="number">1</span>) * s ^ (n - <span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">2</span>: n</div><div class="line">        Rx(:, :, <span class="built_in">i</span>) = Rx(:, :, <span class="built_in">i</span><span class="number">-1</span>) * A + coef(<span class="built_in">i</span> - <span class="number">1</span>) * I;</div><div class="line">        coef(<span class="built_in">i</span>) = <span class="number">-1</span> * trace(Rx(:, :, <span class="built_in">i</span>)* A) / <span class="built_in">i</span>;</div><div class="line">        R = R + Rx(:, :, <span class="built_in">i</span>) * s^(n-<span class="built_in">i</span>);</div><div class="line">        detSA = detSA + coef(<span class="built_in">i</span>) * s ^ (n - <span class="built_in">i</span>);</div><div class="line">    <span class="keyword">end</span></div><div class="line">    <span class="comment">% Compute the transfer function according to system's state space </span></div><div class="line">    <span class="comment">% representation ,the formula as follows:</span></div><div class="line">    <span class="comment">%   G(s) = C * (sI - A)^-1 * B +D</span></div><div class="line">    G = (C * R * B)/ detSA + D;</div><div class="line">    <span class="comment">% Calculate the inverse matrix of characteristic matrix</span></div><div class="line">    <span class="comment">% (sI - A)^-1 = R / detSA</span></div><div class="line">    CSAI = R / detSA;</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>Though the code is implemented, in a real world, the testing and implementation are the same importance to the problem. In the following content, the testing code is provided.</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">% kalman I form </span></div><div class="line">A = [<span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span>; </div><div class="line">     <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span>; </div><div class="line">     <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>; </div><div class="line">     <span class="number">-1</span> <span class="number">-5</span> <span class="number">-3</span> <span class="number">-7</span>];</div><div class="line">B = [<span class="number">0</span>;</div><div class="line">     <span class="number">0</span>;</div><div class="line">     <span class="number">0</span>; </div><div class="line">     <span class="number">1</span>];</div><div class="line">C = [<span class="number">8</span> <span class="number">23</span> <span class="number">2</span> <span class="number">-1</span>];</div><div class="line">D = <span class="number">0</span>;</div><div class="line">[G, CSAI] = ss2tf(A, B , C , D);</div><div class="line">G</div></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">G =</div><div class="line"> </div><div class="line">     -s^<span class="number">3</span> + <span class="number">2</span> s^<span class="number">2</span> + <span class="number">23</span> s + <span class="number">8</span></div><div class="line">  -----------------------------</div><div class="line">  s^<span class="number">4</span> + <span class="number">7</span> s^<span class="number">3</span> + <span class="number">3</span> s^<span class="number">2</span> + <span class="number">5</span> s + <span class="number">1</span></div><div class="line"> </div><div class="line">Continuous-time transfer <span class="function"><span class="keyword">function</span>.</span></div></pre></td></tr></table></figure>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">% standard observable form </span></div><div class="line">A = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">-1</span>; </div><div class="line">     <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">-5</span>; </div><div class="line">     <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">-3</span>; </div><div class="line">     <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">-7</span> ];</div><div class="line">B = [<span class="number">8</span>;</div><div class="line">     <span class="number">23</span>;</div><div class="line">     <span class="number">2</span>; </div><div class="line">     <span class="number">-1</span>];</div><div class="line">C = [<span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>];</div><div class="line">D = <span class="number">0</span>;</div><div class="line">[G, CSAI] = ss2tf(A, B , C , D);</div><div class="line">G</div></pre></td></tr></table></figure>
<p>output:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">G =</div><div class="line"> </div><div class="line">     -s^<span class="number">3</span> + <span class="number">2</span> s^<span class="number">2</span> + <span class="number">23</span> s + <span class="number">8</span></div><div class="line">  -----------------------------</div><div class="line">  s^<span class="number">4</span> + <span class="number">7</span> s^<span class="number">3</span> + <span class="number">3</span> s^<span class="number">2</span> + <span class="number">5</span> s + <span class="number">1</span></div><div class="line"> </div><div class="line">Continuous-time transfer <span class="function"><span class="keyword">function</span>.</span></div></pre></td></tr></table></figure>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28269231923bf2d6a86441e28d24e8930c%29&amp;filter=sc_long_sign&amp;sc_ks_para=q%3D%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%28%E7%AC%AC2%E7%89%88%29&amp;sc_us=8313367311188451873&amp;tn=SE_baiduxueshu_c1gjeupa&amp;ie=utf-8" target="_blank" rel="external">[1] 郑大钟. 线性系统理论(第2版)[J]. 2002.</a></p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/01/18/matlab-3d-plot-function/" class="prev">PREV</a><a href="/2017/12/22/python-pep/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="https://free-free.github.io">infinite.ft</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>