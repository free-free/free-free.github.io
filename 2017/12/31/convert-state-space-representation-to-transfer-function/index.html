<!DOCTYPE html>
<html lang="en">




<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  
  
  
  
    
  
      <title>Convert State Space Representation to Transfer Function - Infinite.ft的博客</title>
  
  
  <meta name="description" content="">
  <meta name="author" content="infinite.ft">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Load scheme css -->
  <link rel="stylesheet" href="/css/lightgallery.css">
  





    <link rel="stylesheet" href="/css/taurus.css">
    
        <link rel="stylesheet" href="/css/scheme-taurus/animations.css">
    


  <!-- load font awesome 5 -->
  <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="/js/social-share.min.js"></script>
    <script src="/js/theme.js"></script>

  <!-- include cookie.js -->
  
  

  <!-- include comment system code -->
  
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  
  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

</head>
<body style="display: flex; flex-direction: column; min-height: 100vh;">

 

<header id="header">
	<div class="header-title">
		
		<div class='header-logo'>
			<a href='/'>
				<img src='/images/avatar.png' />
			</a>
		</div>
		<div class='header-text'>
			<h1>
				<a href="/">Infinite.ft的博客</a>
			</h1>
			<subtitle>
				Hello
			</subtitle>
		</div>
		
	</div>
	<div id='header-nav'>
		



<nav id="nav">
	
	
		
			
		
		
			<div class='nav-item'>
				
					<div class="nav-name active_page">
				
					<a class='nav-link' href="/">
						<span>Home </span>
					</a>
				</div>
			</div>
		
	
	
	<div class='nav-item' id='nav-item-toc'>
		




<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

	</div>
	
	<div class='nav-item' id='nav-item-archive'>
		
				<div class='nav-icon'>
				
			<a href="/archives/" title='Archives'>
			<img src="/images/icons/colorful-outlined/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class='nav-item' id='nav-item-search'>
		
		<div class='nav-icon'>
		
			<a href="/search/" title='Search'>
			<img src="/images/icons/colorful-outlined/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id='nav-item-more'>
		<div class="nav-icon">
				<a href='#' onclick='onClickMenuIcon(event);' ontouchstart='onClickMenuIcon(event);'>
				<img src="/images/icons/colorful-outlined/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
		
			
			
				
			
				
			
				
			
		
			<div class='nav-more-item'>
					<div class="nav-name">
						<a class='nav-link' href="/">
							<span>Home</span>
						</a>
					</div>
			</div>
		
		
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/tech/">
						<span>Tech</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/mylife/">
						<span>Mylife</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/math/">
						<span>Math</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>
</header>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div style="flex: 1;">
      <style>
    body {
        background-color: white;
    }
</style>









    
        
            
            
        
    









    
    
        
    

    
        
    









<article class="article" id="/2017/12/31/convert-state-space-representation-to-transfer-function/" data-name='Convert State Space Representation to Transfer Function' data-version="">

    <!-- Title -->
    <div class='article-header'>
         
         <h1 class='article-title'>
            <a href="/2017/12/31/convert-state-space-representation-to-transfer-function/">
                Convert State Space Representation to Transfer Function
            </a>
        </h1>
        <!-- TODO: support nested categories,display them nicely -->
        
        <ul class='article-categories'>
            
            
                <li><a href="/categories/tech/" data-no-instant>
                    <img src="/images/tech.svg" alt="tech" onerror='if(this.src != "/images/uncategorized.svg") this.src="/images/uncategorized.svg"' title='tech'/>
                </a></li>
            
        </ul>
        
    </div>
    
    <!-- Date and Author -->
    <div class='article-meta'>
    <ul>
            <li><i class='fa fa-calendar'></i> 2017-12-31</li>
            
            <li><i class="fa fa-user"></i> infinite.ft</li>
            
            <li><i class="fas fa-copyright"></i>
            
                
                
            
            
                <a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>CC BY-NC-ND 4.0</a>
            
            </li>
    </ul>
    
<div class="tags">
	
		
			<label class='tag-1'><a href="/tags/matlab/">Matlab</a></label>
		
	
	</div>

    </div>
    <div class='article-cards'>
        <!-- Author Card -->
        <!---
        <div class='Card-article Card-author'>
            <div class='card-title'>
                <h3></h3>
            </div>
            <div class='card-content'>
                    <div class="author-meta">
                            <div class='author-figure'>
                                <img src="" alt="">
                            </div>
                            <div class='author-name'>
                                infinite.ft
                            </div>
                        </div>
                        <div class="author-ai">
                            <div class='author-intro'>
                                <!-- TODO: auto generating author description -->
                                <!-- 
                            </div>
                            <div class="author-articles">
                                <!-- TODO: auto generating author articles -->
                                <!-- <ul>
                                    <li>Article 1</li>
                                    <li>Article 2</li>
                                    <li>Article 3</li>
                                    <li>Article 4</li>
                                    <li>Article 5</li>
                                    <li>Article 6</li>
                                </ul>
                            </div>
                        </div>
            </div>
            
        </div> -->

        <!-- Visit Card -->
        <!-- <div class="Card-article Card-visit"> -->
            <!-- <div class="card-title">
  <h3>Post Visit</h3>
</div>
<div class="card-chart">
  <div id='chart-post-visit'></div>
</div> -->
        <!-- </div> -->
        
        <!-- Auto Excerpt Card -->
        <!-- <div class="Card-article Card-excerpt">
            <div class="card-title">
  <h3>Quick Read</h3>
</div>
<div class="card-text">
  <p id='text-post-summary'>In this semester early, I have enrolled my first-degree course Linear System Theory. The focus of this course is the state space representation  and illustrate the concept of observable and controllable of a linear system. As a student of Control Science and Engineering, I know how  important of...</p>
</div>
        </div> -->
    </div>
    
    <!-- Gallery -->
    <!-- TODO: add a slider to gallery -->
    

    <!-- Content -->
    <!-- TODO: support table of content -->
    <div class="article-toc" id='article-toc'>
        




<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

    </div>
    <div class='article-content'>
    <p>In this semester early, I have enrolled my first-degree course <em>Linear System Theory</em>. The focus of this course is the state space representation  and illustrate the concept of observable and controllable of a linear system. As a student of Control Science and Engineering, I know how  important of it to my career in later life. Everything must be practical, this course is also not an exception. here, as a practice , <strong>I will give a implementation of converting state space to transfer function representation.</strong></p>
<h3 id="Mathematical-representation"><a href="#Mathematical-representation" class="headerlink" title="Mathematical representation"></a>Mathematical representation</h3><p>Given the transfer function of a linear time invariant (LTI) system,as shown below.</p>
<script type="math/tex; mode=display">G(s) = \frac{b\_{m}s^m + b\_{m-1}s^{m-1}+ \dotsb + b\_{1}s + b\_{0}}{s^n + \alpha\_{n-1}s^{n-1} + \alpha\_{n-2}s^{n-2} + \dotsb + \alpha\_{1}s+\alpha\_{0}}</script><p>It’s state space representation as follows.</p>
<script type="math/tex; mode=display">\begin{cases}\dot{x} = Ax + Bu \\\\ y = Cx + Du\end{cases}</script><p> In the above equation,$x$ is the state vector of system, $u$ is the input and $y$ is the output. $A$ called system matrix, it’s dimension is $n\times n$ .B called input matrix, it’s dimension is $n \times p$. C called output matrix , it’s dimension is $q \times n$. D called input &amp; output relational matrix, it’s dimension is $q \times p$.</p>
<p>According to system’s transfer function , it’s <em>kalman I form</em>  , <em>kalman II form</em> and <em>standard observable  form</em> can be easily provided. Conversely,  given the state space representation , the transfer function could be given in the following formula.</p>
<script type="math/tex; mode=display">G(s) = C(sI - A)^{-1}B + D</script><p>Here the calculation of $(sI - A)^{-1}$ is cumbersome,  especially for student who has no assistance with computer.The computational  method of $(sI - A)^{-1}$ can be given in a more comprehensive way, as shown below.</p>
<script type="math/tex; mode=display">(sI - A)^{-1} = \frac{adj(sI - A)}{det(sI - A)}</script><script type="math/tex; mode=display">adj(sI - A) = R\_{n-1}s^{n-1} +R\_{n-2}s^{n-2} + \dotsb + R\_1s + R\_0</script><script type="math/tex; mode=display">det(sI - A) = s^n + a\_{n-1}s^{n-1} + a\_{n-2}s^{n-2}+ \dotsb + a\_1s + a\_0</script><p>So here i have already given  the method of computation of $(sI - A)^{-1}$, the next question is how to calculate $R_{n-1}, R_{n-2}, \dots, R_0$ and $a_{n-1}, a_{n-1}, \dots, a_{0}$. The relationship of them is brief and clear.</p>
<script type="math/tex; mode=display">\begin{cases} R\_{n-1} =  I,a\_{n-1} = - \frac{tr(R\_{n-1}A)}{1} \\\\ R\_{n-2} = R\_{n-1}A + a\_{n-1}I, a\_{n-2}= -\frac{tr(R\_{n-2}A)}{2} \\\\ \cdots \\\\  \cdots \\\\ R\_{1} = R\_{2}A + a\_{2}I, a\_{1}= -\frac{tr(R\_{1}A)}{(n-1)} \\\\ R\_{0} = R\_{1}A + a\_{1}I, a\_{0}= -\frac{tr(R\_{0}A)}{n}\end{cases}</script><p>As shown above,  $R_{n-1}$ and $a_{n-1}$  are firstly calculated, $R_{n-2}$ and $a_{n-2}$ are followed, then continue the calculation process until the subscript of $R$ and $a$ is reached to <em>$0$</em>. According to equations above, we can easily give the implementation of converting to state space representation to transfer function representation using Matlab. </p>
<h3 id="Matlab-implementation"><a href="#Matlab-implementation" class="headerlink" title="Matlab implementation"></a>Matlab implementation</h3><p>In the previous section, we already have introduced mathematics basis of state space representation and transfer function representation of the linear system, and given the method of conversion between each other. So the process of implementing it is much easier using computer language, here I give an implementation using Matlab, the code as follows.</p>
<pre><code class="lang-matlab">% @file: ss2tf.m
% @description: 
%     The reponsibility of this function is to convert the linear 
%     system&#39;s state  space representation to transfer function
%     representation.
% @paras: A, system matrix
% @paras: B, input matrix
% @paras: C, ouput matrix
% @paras: D, input&amp;ouput relational matrix
% @return: G, transfer function
% @return: CSAI, the inverse matrix of characteristic matrix of A
%
function [G, CSAI] = ss2tf(A, B, C, D)
    % Get the dimension number of state space representation
    n = size(A, 1);
    % Generate the identity matrix which&#39;s dimension size is same as A
    I = eye(size(A));
    % Coefficient array of determinant of A
    coef = ones(n, 1);
    % R matrix 
    Rx = zeros(n, n ,n);
    % Calculate the Rn-1
    Rx(:, :, 1) = I;
    % Calculate the an-1
    coef(1) = -trace(I * A);
    % Define the laplace variable &#39;s&#39;
    s = tf(&#39;s&#39;);
    % Calculate the first part of R = Rn-1 * Sn-1
    R = Rx(:, :, 1) * s^(n-1);
    % Calculate the first and second part of determinant of A
    % i.e. s^n + an-1 * s^(n-1) + ... + a0
    detSA = s^n + coef(1) * s ^ (n - 1);
    for i = 2: n
        Rx(:, :, i) = Rx(:, :, i-1) * A + coef(i - 1) * I;
        coef(i) = -1 * trace(Rx(:, :, i)* A) / i;
        R = R + Rx(:, :, i) * s^(n-i);
        detSA = detSA + coef(i) * s ^ (n - i);
    end
    % Compute the transfer function according to system&#39;s state space 
    % representation ,the formula as follows:
    %   G(s) = C * (sI - A)^-1 * B +D
    G = (C * R * B)/ detSA + D;
    % Calculate the inverse matrix of characteristic matrix
    % (sI - A)^-1 = R / detSA
    CSAI = R / detSA;
end
</code></pre>
<p>Though the code is implemented, in a real world, the testing and implementation are the same importance to the problem. In the following content, the testing code is provided.</p>
<pre><code class="lang-matlab">% kalman I form 
A = [0 1 0 0; 
     0 0 1 0; 
     0 0 0 1; 
     -1 -5 -3 -7];
B = [0;
     0;
     0; 
     1];
C = [8 23 2 -1];
D = 0;
[G, CSAI] = ss2tf(A, B , C , D);
G
</code></pre>
<p>output:</p>
<pre><code class="lang-matlab">G =

     -s^3 + 2 s^2 + 23 s + 8
  -----------------------------
  s^4 + 7 s^3 + 3 s^2 + 5 s + 1

Continuous-time transfer function.
</code></pre>
<pre><code class="lang-matlab">% standard observable form 
A = [0 0 0 -1; 
     1 0 0 -5; 
     0 1 0 -3; 
     0 0 1 -7 ];
B = [8;
     23;
     2; 
     -1];
C = [0 0 0 1];
D = 0;
[G, CSAI] = ss2tf(A, B , C , D);
G
</code></pre>
<p>output:</p>
<pre><code class="lang-matlab">G =

     -s^3 + 2 s^2 + 23 s + 8
  -----------------------------
  s^4 + 7 s^3 + 3 s^2 + 5 s + 1

Continuous-time transfer function.
</code></pre>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28269231923bf2d6a86441e28d24e8930c%29&amp;filter=sc_long_sign&amp;sc_ks_para=q%3D%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%28%E7%AC%AC2%E7%89%88%29&amp;sc_us=8313367311188451873&amp;tn=SE_baiduxueshu_c1gjeupa&amp;ie=utf-8" target="_blank" rel="external">[1] 郑大钟. 线性系统理论(第2版)[J]. 2002.</a></p>

    
    </div>
    
    
        
</article>
  </div>

  

<footer id='footer'>
    <div class='footer-copyright'>
        <div>
            <p> Copyright by <a href="">infinite.ft </a> @ 2018</p>
            <p>Designed by: <i class="fas fa-paint-brush"></i> <a href="https://moober.cn">Moober</a> and <i class="fas fa-graduation-cap"></i> <a href="https://qutang.github.io">Qu Tang</a> &bull; Theme: <a href="">Cutie 2.0.6-beta-Taurus</a> &bull; Powered by <a href="http://hexo.io">Hexo.</a></p>
        </div>
    </div>
    
    <div class='footer-social'>
        
            
                
                    <div class='footer-social-item'><a href='https://github.com/free-free' target='_blank' ><i class="fab fa-github fa-2x" aria-hidden="true"></i></a></div>
                
            
        
    </div>
</footer>

  <br>

  <div id="footer-nav">
		



<nav id="nav">
	
	
		
			
				
			
		
		
	
	
	<div class='nav-item' id='nav-item-toc'>
		




<div class="toc-button" onclick='toggleTOC(event);' ontouchstart='toggleTOC(event);'>
    <img src="/images/icons/colorful-outlined/toc.svg" alt="">
</div>

	</div>
	
	<div class='nav-item' id='nav-item-archive'>
		
				<div class='nav-icon'>
				
			<a href="/archives/" title='Archives'>
			<img src="/images/icons/colorful-outlined/archive.svg" alt="">
			</a>
		</div>
	</div>
	<div class='nav-item' id='nav-item-search'>
		
		<div class='nav-icon'>
		
			<a href="/search/" title='Search'>
			<img src="/images/icons/colorful-outlined/search.svg" alt="">
			</a>
		</div>
	</div>
	<div class="nav-item" id='nav-item-more'>
		<div class="nav-icon">
				<a href='#' onclick='onClickMenuIcon(event);' ontouchstart='onClickMenuIcon(event);'>
				<img src="/images/icons/colorful-outlined/menu.svg" alt="">
				</a>
		</div>
		<div class="nav-more-menu">
		
			
			
				
			
				
			
				
			
		
			<div class='nav-more-item'>
					<div class="nav-name">
						<a class='nav-link' href="/">
							<span>Home</span>
						</a>
					</div>
			</div>
		
		
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/tech/">
						<span>Tech</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/mylife/">
						<span>Mylife</span>
					</a>
				</div>
		</div>
		
		<div class='nav-more-item'>
				<div class="nav-name">
					<a class='nav-link' href="/categories/math/">
						<span>Math</span>
					</a>
				</div>
		</div>
		
	</div>
	</div>
</nav>

	</div>

  



    







  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
<script src="/js/lightgallery.min.js"></script>
<script src="/js/lg-zoom.min.js"></script>
<script type='text/javascript'>
    $(document).ready(function() {
        $("#lightgallery").lightGallery(); 
        $(".article-content img").each(function(){
            console.log($(this).attr('src'))
            $(this).attr('data-src', $(this).attr('src')).lightGallery({
                selector: 'this'
            })
        });
    });
</script>








<script src="/js/post.js"></script>

<script data-no-instant type='text/javascript'>
changeLayoutOnTouchScreen();


var post = new Post('', '');
        post.getCommentCount(window.location.pathname, function(count){
            $('#article-comment-count').text(count);
        });
        post.addVisitRecord(window.location.pathname, userip);
        post.getVisitCount(window.location.pathname, function(count){
            $('#article-visit-count').text(count);
        });
post.updatePostVersion(window.location.pathname);


</script>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
