<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  
  
  
  
    
  
      <title>Convert State Space Representation to Transfer Function - Infinite.ft的博客</title>
  
  
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href="//fonts.googleapis.com/css?family=Raleway:400,300,600" rel="stylesheet" type="text/css">

  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->

  <link rel="stylesheet" href="/css/normalize.css">
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/gridlex.min.css">
<link rel="stylesheet" href="/css/skeleton.css">
<link rel="stylesheet" href="/css/theme.css">
<link rel="stylesheet" href="/css/share.min.css">
<link rel="stylesheet" href="/css/lightgallery.css">

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [["$","$"],['\\(','\\)']]}
  });
  </script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src="/js/social-share.min.js"></script>
    <script src="/js/theme.js"></script>

  <!-- include cookie.js -->
  
  

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

<link rel="stylesheet" href="/css/prism-atom-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body style="display: flex; flex-direction: column; min-height: 100vh;">
  <header class="header">
	<div class="header-title">
		
			<div class='header-logo'><a href='/'>
				<img class='grow' src='/images/avatar.png' />
			</a></div>
			<div class='header-text' >
			    <h1>Infinite.ft的博客</h1>
				<p><small></small></p>
			</div>
		
	</div>
	<div id="header-menu-container">
		<nav class="menu">
	
		
	
	<div class='menu-item grow'>
		<div class='menu-icon'>
			<a href="/archives/">
			<img src="/images/archive.svg" alt="">
			</a>
		</div>
		<div class="menu-name">
			<a class='menu-link' href="/archives/">
				<span>Archives</span>
			</a>
		</div>
	</div>
	
	
		
		
			<div class='menu-item grow'>
			
				<div class='menu-icon'>
				<a href="/">
					<img src="/images/home.svg" alt="">
					</a>
					</div>
					
					<div class="menu-name">
						<a class='menu-link' href="/">
							<span>Home</span>
						</a>
					</div>
				</a>
			</div>
		
	
	<div class='menu-item grow'>
		<div class='menu-icon'>
			<a href="/search/">
			<img src="/images/search.svg" alt="">
			</a>
		</div>
		<div class="menu-name">
			<a class='menu-link' href="/search/">
				<span>Search</span>
			</a>
		</div>
	</div>
</nav>

	</div>
</header>

  <!-- Primary Page Layout
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <div style="flex: 1;">
      <style>
    body {
        background-color: white;
    }
</style>

<article class="article" id="/2017/12/31/convert-state-space-representation-to-transfer-function/" data-name='Convert State Space Representation to Transfer Function' data-version="">

    <!-- Title -->

    
        
            
                
                
            
        
    

    <div class='article-header'>
         
         <h1 class='article-title'>
            <a href="/2017/12/31/convert-state-space-representation-to-transfer-function/">
                Convert State Space Representation to Transfer Function
            </a>
        </h1>
        
        <ul class='article-categories'>
            
            
                <li><a href="/categories/tech/" data-no-instant>
                    <img src="/images/tech.svg" alt="tech" />
                </a></li>
            
        </ul>
        
    </div>
   
    <!-- Date and Author -->
    <p>
       	2017-12-31
        by infinite.ft
        
    </p>
    <p>
        

	
		<label><a href="/tags/matlab/">#Matlab</a></label>
	


    </p>
	<hr />

    <!-- Gallery -->
    
    

    <!-- Content -->
    <div class='article-content'>
    <p>In this semester early, I have enrolled my first-degree course <em>Linear System Theory</em>. The focus of this course is the state space representation  and illustrate the concept of observable and controllable of a linear system. As a student of Control Science and Engineering, I know how  important of it to my career in later life. Everything must be practical, this course is also not an exception. here, as a practice , <strong>I will give a implementation of converting state space to transfer function representation.</strong></p>
<h3 id="Mathematical-representation"><a href="#Mathematical-representation" class="headerlink" title="Mathematical representation"></a>Mathematical representation</h3><p>Given the transfer function of a linear time invariant (LTI) system,as shown below.</p>
<script type="math/tex; mode=display">G(s) = \frac{b\_{m}s^m + b\_{m-1}s^{m-1}+ \dotsb + b\_{1}s + b\_{0}}{s^n + \alpha\_{n-1}s^{n-1} + \alpha\_{n-2}s^{n-2} + \dotsb + \alpha\_{1}s+\alpha\_{0}}</script><p>It’s state space representation as follows.</p>
<script type="math/tex; mode=display">\begin{cases}\dot{x} = Ax + Bu \\\\ y = Cx + Du\end{cases}</script><p> In the above equation,$x$ is the state vector of system, $u$ is the input and $y$ is the output. $A$ called system matrix, it’s dimension is $n\times n$ .B called input matrix, it’s dimension is $n \times p$. C called output matrix , it’s dimension is $q \times n$. D called input &amp; output relational matrix, it’s dimension is $q \times p$.</p>
<p>According to system’s transfer function , it’s <em>kalman I form</em>  , <em>kalman II form</em> and <em>standard observable  form</em> can be easily provided. Conversely,  given the state space representation , the transfer function could be given in the following formula.</p>
<script type="math/tex; mode=display">G(s) = C(sI - A)^{-1}B + D</script><p>Here the calculation of $(sI - A)^{-1}$ is cumbersome,  especially for student who has no assistance with computer.The computational  method of $(sI - A)^{-1}$ can be given in a more comprehensive way, as shown below.</p>
<script type="math/tex; mode=display">(sI - A)^{-1} = \frac{adj(sI - A)}{det(sI - A)}</script><script type="math/tex; mode=display">adj(sI - A) = R\_{n-1}s^{n-1} +R\_{n-2}s^{n-2} + \dotsb + R\_1s + R\_0</script><script type="math/tex; mode=display">det(sI - A) = s^n + a\_{n-1}s^{n-1} + a\_{n-2}s^{n-2}+ \dotsb + a\_1s + a\_0</script><p>So here i have already given  the method of computation of $(sI - A)^{-1}$, the next question is how to calculate $R_{n-1}, R_{n-2}, \dots, R_0$ and $a_{n-1}, a_{n-1}, \dots, a_{0}$. The relationship of them is brief and clear.</p>
<script type="math/tex; mode=display">\begin{cases} R\_{n-1} =  I,a\_{n-1} = - \frac{tr(R\_{n-1}A)}{1} \\\\ R\_{n-2} = R\_{n-1}A + a\_{n-1}I, a\_{n-2}= -\frac{tr(R\_{n-2}A)}{2} \\\\ \cdots \\\\  \cdots \\\\ R\_{1} = R\_{2}A + a\_{2}I, a\_{1}= -\frac{tr(R\_{1}A)}{(n-1)} \\\\ R\_{0} = R\_{1}A + a\_{1}I, a\_{0}= -\frac{tr(R\_{0}A)}{n}\end{cases}</script><p>As shown above,  $R_{n-1}$ and $a_{n-1}$  are firstly calculated, $R_{n-2}$ and $a_{n-2}$ are followed, then continue the calculation process until the subscript of $R$ and $a$ is reached to <em>$0$</em>. According to equations above, we can easily give the implementation of converting to state space representation to transfer function representation using Matlab. </p>
<h3 id="Matlab-implementation"><a href="#Matlab-implementation" class="headerlink" title="Matlab implementation"></a>Matlab implementation</h3><p>In the previous section, we already have introduced mathematics basis of state space representation and transfer function representation of the linear system, and given the method of conversion between each other. So the process of implementing it is much easier using computer language, here I give an implementation using Matlab, the code as follows.</p>
<pre class="line-numbers language-lang-matlab"><code class="language-lang-matlab">% @file: ss2tf.m
% @description: 
%     The reponsibility of this function is to convert the linear 
%     system's state  space representation to transfer function
%     representation.
% @paras: A, system matrix
% @paras: B, input matrix
% @paras: C, ouput matrix
% @paras: D, input&ouput relational matrix
% @return: G, transfer function
% @return: CSAI, the inverse matrix of characteristic matrix of A
%
function [G, CSAI] = ss2tf(A, B, C, D)
    % Get the dimension number of state space representation
    n = size(A, 1);
    % Generate the identity matrix which's dimension size is same as A
    I = eye(size(A));
    % Coefficient array of determinant of A
    coef = ones(n, 1);
    % R matrix 
    Rx = zeros(n, n ,n);
    % Calculate the Rn-1
    Rx(:, :, 1) = I;
    % Calculate the an-1
    coef(1) = -trace(I * A);
    % Define the laplace variable 's'
    s = tf('s');
    % Calculate the first part of R = Rn-1 * Sn-1
    R = Rx(:, :, 1) * s^(n-1);
    % Calculate the first and second part of determinant of A
    % i.e. s^n + an-1 * s^(n-1) + ... + a0
    detSA = s^n + coef(1) * s ^ (n - 1);
    for i = 2: n
        Rx(:, :, i) = Rx(:, :, i-1) * A + coef(i - 1) * I;
        coef(i) = -1 * trace(Rx(:, :, i)* A) / i;
        R = R + Rx(:, :, i) * s^(n-i);
        detSA = detSA + coef(i) * s ^ (n - i);
    end
    % Compute the transfer function according to system's state space 
    % representation ,the formula as follows:
    %   G(s) = C * (sI - A)^-1 * B +D
    G = (C * R * B)/ detSA + D;
    % Calculate the inverse matrix of characteristic matrix
    % (sI - A)^-1 = R / detSA
    CSAI = R / detSA;
end
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Though the code is implemented, in a real world, the testing and implementation are the same importance to the problem. In the following content, the testing code is provided.</p>
<pre class="line-numbers language-lang-matlab"><code class="language-lang-matlab">% kalman I form 
A = [0 1 0 0; 
     0 0 1 0; 
     0 0 0 1; 
     -1 -5 -3 -7];
B = [0;
     0;
     0; 
     1];
C = [8 23 2 -1];
D = 0;
[G, CSAI] = ss2tf(A, B , C , D);
G
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>output:</p>
<pre class="line-numbers language-lang-matlab"><code class="language-lang-matlab">G =

     -s^3 + 2 s^2 + 23 s + 8
  -----------------------------
  s^4 + 7 s^3 + 3 s^2 + 5 s + 1

Continuous-time transfer function.
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-lang-matlab"><code class="language-lang-matlab">% standard observable form 
A = [0 0 0 -1; 
     1 0 0 -5; 
     0 1 0 -3; 
     0 0 1 -7 ];
B = [8;
     23;
     2; 
     -1];
C = [0 0 0 1];
D = 0;
[G, CSAI] = ss2tf(A, B , C , D);
G
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>output:</p>
<pre class="line-numbers language-lang-matlab"><code class="language-lang-matlab">G =

     -s^3 + 2 s^2 + 23 s + 8
  -----------------------------
  s^4 + 7 s^3 + 3 s^2 + 5 s + 1

Continuous-time transfer function.
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://xueshu.baidu.com/s?wd=paperuri%3A%28269231923bf2d6a86441e28d24e8930c%29&amp;filter=sc_long_sign&amp;sc_ks_para=q%3D%E7%BA%BF%E6%80%A7%E7%B3%BB%E7%BB%9F%E7%90%86%E8%AE%BA%28%E7%AC%AC2%E7%89%88%29&amp;sc_us=8313367311188451873&amp;tn=SE_baiduxueshu_c1gjeupa&amp;ie=utf-8" target="_blank" rel="external">[1] 郑大钟. 线性系统理论(第2版)[J]. 2002.</a></p>

    </div>
    <hr />

    <h2>Share and comment</h2>
    <div class="social-share"></div>
    
        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    

    
    
</article>
  </div>

  <footer class='footer'>
    <div class='footer-logo'>
        <span>infinite.ft</span>
    </div>
    <div class='footer-social'>
        
        
            
                
                    <div class='footer-social-item'><a href='https://www.facebook.com/huang.biao.77' target='_blank' title='Find me on facebook' ><i class="fa fa-facebook fa-2x" aria-hidden="true"></i></a></div>
                
            
                
                    <div class='footer-social-item'><a href='https://twitter.com/19941222hb' target='_blank' title='Find me on twitter' ><i class="fa fa-twitter fa-2x" aria-hidden="true"></i></a></div>
                
            
                
                    <div class='footer-social-item'><a href='mailto:infinite.ft@gmail.com' target='_blank' title='Find me on mail' ><i class="fa fa-mail fa-2x" aria-hidden="true"></i></a></div>
                
            
        
    </div>
    <p> Copyright by <a href="">@infinite.ft</a> in 2018</p>
    <p> Icons by <a href="http://www.freepik.com" title="Freepik">Freepik</a> from <a href="http://www.flaticon.com" title="Flaticon">Flaticon</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0</a></p>
    <p>Theme <a href="http://qutang.github.io/2017/06/27/Hexo-theme-cutie/">Cutie 1.0.0</a> | Powered by <a href="http://hexo.io">Hexo.</a></p>
</footer>

  <br>

  <div id="footer-menu-container">
		<nav class="menu">
	
		
	
	<div class='menu-item grow'>
		<div class='menu-icon'>
			<a href="/archives/">
			<img src="/images/archive.svg" alt="">
			</a>
		</div>
		<div class="menu-name">
			<a class='menu-link' href="/archives/">
				<span>Archives</span>
			</a>
		</div>
	</div>
	
	
		
		
			<div class='menu-item grow'>
			
				<div class='menu-icon'>
				<a href="/">
					<img src="/images/home.svg" alt="">
					</a>
					</div>
					
					<div class="menu-name">
						<a class='menu-link' href="/">
							<span>Home</span>
						</a>
					</div>
				</a>
			</div>
		
	
	<div class='menu-item grow'>
		<div class='menu-icon'>
			<a href="/search/">
			<img src="/images/search.svg" alt="">
			</a>
		</div>
		<div class="menu-name">
			<a class='menu-link' href="/search/">
				<span>Search</span>
			</a>
		</div>
	</div>
</nav>

	</div>

  <script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://qutang-github-io.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>

<script src="/js/lightgallery.min.js"></script>
<script type='text/javascript'>
    lightGallery(document.getElementById('lightgallery'));
</script>

<script data-no-instant type='text/javascript'>
changeLayoutOnTouchScreen();
setVersionForCurrentPage();
setVersionBadgeForIndexPages();
</script>

<!-- End Document
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
</body>
</html>
